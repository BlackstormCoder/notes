

Authenticate
==============


IP: 10.10.42.202

Dictionary Attack
-------------------

You know this, and have used in burp... So no notes.
	I did created a custom wordlist on top 100 words from rockyou (the ones in the beginning and loaded into the burp)

	Mike Flag: e1faaa144df2f24aa0a9284f4a5bb578

Re-Registration
------------------

	With a developer's irresponsibility to not sanitize the input the user has entered can lead to duplicacy of account creation like "darren"==" darren" (spot the space) and hence we can get access to any user's account.

	Arthur Flag: d9ac0f7db4fda460ac3edeb75d75e16e

JWT Json Web Token
--------------------

This is something new... 

- JWT is used for authentication; generated by HMAC hashing or private/public keys. They are commonly used to define the access permissions of a user on a particular site.

They are hashes... The difference is that, after decoding they result in a json format.

JWT is divided into 3 parts(separated by dots (.)):
	- Header - Consists of algorithm used
	- Payload - This is the part which tells that a certain user has this much access.
	- Signature - This is the part which contains the hash of the token, and ensures the integrity of the data.

	We decode each part with base64 and then join them via dot.

This is a very secure way of authentication IF AND ONLY IF USED PROPERLY. But developers you know, always tend to make mistakes.

The attack is that, an attacker can login as a low privileged user and extract the JWT token, decode it, make changes and encode again... And can be authenticated easily as another or admin user.

Finally, after so many tries... I was going wrong... We needed a \n after both part... So that they end in 'K' and then copy pasted the the token to get admin access.

Token of user:user
	
	eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOjE2MDc4MDkwNDMsImlhdCI6MTYwNzgwODc0MywibmJmIjoxNjA3ODA4NzQzLCJpZGVudGl0eSI6MX0.qRPqeqmDnMdqfoUPAz4z9qvwvj6W28ixmXXh8SAJs8E

	When Decoded:

	{"typ":"JWT","alg":"HS256"}{"exp":1607809043,"iat":1607808743,"nbf":1607808743,"identity":1}

	Edited:

	{"typ":"JWT","alg":"NONE"}{"exp":1607809043,"iat":1607808743,"nbf":1607808743,"identity":0}

	Admin Token:

	eyJ0eXAiOiJKV1QiLCJhbGciOiJOT05FIn0K.eyJleHAiOjE2MDc4MDg3NjAsImlhdCI6MTYwNzgwODQ2MCwibmJmIjoxNjA3ODA4NDYwLCJpZGVudGl0eSI6MH0K.

Admin Flag: 92498880383088033228


No Auth
--------

This is the noobest in the room. We can authenticate by creating a new account and then change the URL accordingly to the user space... In our case the superadmin userspace was at /users/0

Superadmin Password: abcd1234
Superadmin Flag: 72102933396288983011

This is it for the room.